#!/bin/sh

setup() {

if test -z "${DISPLAY}"
then
HOSTNAME=`hostname`
DISPLAY=${HOSTNAME}:0.0
fi
DOCUSHARE_HOME=${HOME}/jDocuShareNext/dist
LIB_JARS=${DOCUSHARE_HOME}/lib
POLICY_FILE=${DOCUSHARE_HOME}/config/policy
JAVA_HOME=${DOCUSHARE_HOME}/jre
TOMCAT_HOME=${DOCUSHARE_HOME}/tomcat
CATALINA_HOME=${DOCUSHARE_HOME}/tomcat
CATALINA_BASE=${DOCUSHARE_HOME}/tomcat
VERITY_HOME=${DOCUSHARE_HOME}/lib/verity
VERITY_BIN=${VERITY_HOME}/Verity_Export_SDK/bin
VERITY_FILTERS_BIN=${VERITY_HOME}/Filter_SDK/bin
IDOL_HOME=${DOCUSHARE_HOME}/IDOLServer
IDOL_DISH_HOME=${IDOL_HOME}/DiSH
IDOL_FSF_HOME=${IDOL_HOME}/FileSystemFetch
IDOL_SERVER_HOME=${IDOL_HOME}/IDOL
IDOL_CONTENT0=${IDOL_HOME}/content0
IDOL_CONTENT1=${IDOL_HOME}/content1
DSDIS_BIN=${DOCUSHARE_HOME}/lib/dsdis/bin
PATH=${JAVA_HOME}/bin:${TOMCAT_HOME}/bin:${DOCUSHARE_HOME}/bin:${PATH}
PATH=${VERITY_BIN}:${VERITY_FILTERS_BIN}:${IDOL_DISH_HOME}:${IDOL_FSF_HOME}:${IDOL_SERVER_HOME}:${IDOL_SERVER_HOME}/langfiles:${IDOL_CONTENT0}:${IDOL_CONTENT1}:${PATH}
JDOCUSHARE=${DOCUSHARE_HOME}
TOMCAT_OPTS="-Ddocushare.home=${DOCUSHARE_HOME} -Dcom.xerox.docushare.install=${DOCUSHARE_HOME} -Dcom.xerox.docushare.config=${DOCUSHARE_HOME}/config -Djava.library.path=${JDOCUSHARE}/bin"
CATALINA_OPTS=${TOMCAT_OPTS}


MY_CLASSPATH=
MY_CLASSPATH=${LIB_JARS}/jdom.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/jdomutil.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/jaxen.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/xercesImpl.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/xalan.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/log4j.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/monitor.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/stubs.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/ds4monitor.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/dsapi.jar:${MY_CLASSPATH}
MY_CLASSPATH=${LIB_JARS}/dscommon.jar:${MY_CLASSPATH}

# Configure CLASSPATH property in case of out-of-process HTML Conversion
if [ "${CLASSPATH}" = "" ]
then
  CLASSPATH=${VERITY_BIN}
else
  CLASSPATH=${VERITY_BIN}:${CLASSPATH}
fi


if [ "${LD_LIBRARY_PATH}" = "" ]
then
  LD_LIBRARY_PATH=${JDOCUSHARE}/bin:${VERITY_BIN}:${IDOL_DISH_HOME}:${IDOL_FSF_HOME}:${IDOL_FSF_HOME}/filters:${IDOL_SERVER_HOME}:${IDOL_SERVER_HOME}/langfiles:${DSDIS_BIN}:/lib:/usr/lib
else
  LD_LIBRARY_PATH=${JDOCUSHARE}/bin:${VERITY_BIN}:${IDOL_DISH_HOME}:${IDOL_FSF_HOME}:${IDOL_FSF_HOME}/filters:${IDOL_SERVER_HOME}:${IDOL_SERVER_HOME}/langfiles:${DSDIS_BIN}:${LD_LIBRARY_PATH}:/lib:/usr/lib
fi

ENV_SETUP="YES"

export DISPLAY
export PATH
export CLASSPATH
export MY_CLASSPATH
export VERITY_BIN
export VERITY_HOME
export LD_LIBRARY_PATH
export ENV_SETUP
export DOCUSHARE_HOME
export JAVA_HOME

export CATALINA_BASE
export CATALINA_HOME
export CATALINA_OPTS
export DSDIS_BIN
export HOSTNAME
export IDOL_CONTENT0
export IDOL_CONTENT1
export IDOL_DISH_HOME
export IDOL_FSF_HOME
export IDOL_HOME
export IDOL_SERVER_HOME
export JDOCUSHARE
export LIB_JARS
export POLICY_FILE
export TOMCAT_HOME
export TOMCAT_OPTS
export VERITY_FILTERS_BIN

# set file descriptors to 2048 for IDOL
ulimit -n 2048

} 

if [ "$ENV_SETUP" != "YES" ]
then
   setup;
fi

